---
description: 
globs: 
alwaysApply: true
---
# Security Features

The ECG monitoring system implements several security measures to protect sensitive patient data:

## Data Protection

- **Sensitive Data Hashing**: Patient identifiers are securely hashed using SHA-256 with a security key
  - Implementation in [web/config/security.php](mdc:web/config/security.php)
  - Uses `hashSensitiveData()` function for consistent data lookup

- **Password Hashing**: User passwords and remember tokens use bcrypt
  - Implementation in [web/config/security.php](mdc:web/config/security.php)
  - Uses PHP's native `password_hash` and `password_verify` functions

- **Encoding**: Personal information is encoded in base64
  - Functions for encoding/decoding in [web/config/security.php](mdc:web/config/security.php)
  - Applied to patient names, addresses, and identification numbers

## Authentication & Authorization

- **Password Hashing**: User passwords are securely hashed with bcrypt
  - Password verification implemented in security functions
  - Protects against database breaches

- **Remember Me**: Secure "Remember Me" functionality with token rotation
  - Tokens are securely stored with bcrypt hashing
  - Tokens are automatically rotated on successful login for enhanced security
  - Implementation in [web/config/security.php](mdc:web/config/security.php)

- **CSRF Protection**: Forms are protected against Cross-Site Request Forgery
  - Token generation and verification in [web/config/security.php](mdc:web/config/security.php)
  - Applied to all sensitive form submissions

- **Input Sanitization**: All user inputs are sanitized to prevent injection attacks
  - Special character escaping and input cleaning
  - Parameterized SQL queries via PDO

