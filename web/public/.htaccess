# Enable rewriting
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /
    
    # Redirect to https (uncomment in production)
    # RewriteCond %{HTTPS} off
    # RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]
    
    # Properly handle /pages/ directory requests
    RewriteRule ^pages/(.*)$ ../pages/$1 [L]
    
    # Properly handle /api/ directory requests
    RewriteRule ^api/(.*)$ ../api/$1 [L]
    
    # If the request is not for a file or directory, route through index.php
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^ index.php [L]
</IfModule>

# Directory access settings
Options FollowSymLinks

# Protect sensitive files
<FilesMatch "^\.">
    Order allow,deny
    Deny from all
</FilesMatch>

# PHP settings
<IfModule mod_php8.c>
    php_flag display_errors Off
    php_value max_execution_time 30
    php_value memory_limit 128M
    php_value post_max_size 8M
    php_value upload_max_filesize 8M
</IfModule> 